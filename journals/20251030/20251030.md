- Run
    - Gym - hopper/walker2d/halfcheetah
        - `python script/run.py --config-name=pre_diffusion_mlp --config-dir=cfg/gym/pretrain/hopper-medium-v2`
        - Easy
    - Gym - hopper/walker2d/halfcheetah
        - `python script/run.py --config-name=ft_ppo_diffusion_mlp --config-dir=cfg/gym/finetune/hopper-v2 wandb=null`
        - Hard
        - Solve path:
            - `conda install -c conda-forge glew glfw mesalib libegl libglvnd xorg-libx11 xorg-libxrandr xorg-libxcursor xorg-libxinerama xorg-libxi`
                - Also need `conda install -c conda-forge xorg-libgl -y`
                - Solved: `ERROR: ld.so: object '/usr/lib/x86_64-linux-gnu/libGLEW.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.`, `#include <GL/glew.h>`, and `distutils.errors.DistutilsExecError: command '/hpc/software/spack_v20d1/spack/opt/spack/linux-rhel7-x86_64/gcc-4.8.5/llvm-7.1.0-6hpm7mhqatqvlmnmtyz32dnlr6ljfxja/bin/clang' failed with exit code 1`
                - Need: `unset LD_PRELOAD`
            - `python -m pip install -U absl-py`
                - Solved: `ABSLLogger.findCaller() takes from 1 to 2 positional arguments but 3 were given`
        - 2nd round:
            - `conda install -n dppo_310_1 -c conda-forge glew -y`
        - Example logs: see `log 2`
    - D3IL: seems like work without the `mujoco_py` building issue
        - `python script/run.py --config-name=ft_ppo_diffusion_mlp --config-dir=cfg/d3il/finetune/avoid_m1 wandb=null`

- log 1

```sh

```


- log 2

```sh
$ python script/run.py --config-name=ft_ppo_diffusion_mlp --config-dir=cfg/gym/finetune/hopper-v2 wandb=null
Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[2025-10-30 13:39:27,031][absl][INFO] - MUJOCO_GL is not set, so an OpenGL backend will be chosen automatically.
/home/kzy816/.conda/envs/dppo_310/lib/python3.10/site-packages/glfw/__init__.py:917: GLFWError: (65550) b'X11: The DISPLAY environment variable is missing'
  warnings.warn(message, GLFWError)
[2025-10-30 13:39:27,071][absl][INFO] - Successfully imported OpenGL backend: glfw
[2025-10-30 13:39:27,525][absl][INFO] - MuJoCo library version is: 3.3.7
pybullet build time: Jan 29 2025 23:16:28
/home/kzy816/.conda/envs/dppo_310/lib/python3.10/site-packages/pybullet_envs/env_bases.py:8: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
/home/kzy816/.conda/envs/dppo_310/lib/python3.10/site-packages/gym/spaces/box.py:78: UserWarning: WARN: Box bound precision lowered by casting to float32
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
[2025-10-30 13:39:42,461][root][INFO] - Loaded SL-trained policy from /projects/p30309/RL/dppo/log/gym-pretrain/hopper-medium-v2_pre_diffusion_mlp_ta4_td20/2024-06-12_23-10-05/checkpoint/state_3000.pt
[2025-10-30 13:39:42,461][root][INFO] - Number of network parameters: 553020
[2025-10-30 13:39:43,008][root][INFO] - Cloned model for fine-tuning
[2025-10-30 13:39:43,009][root][INFO] - Turned off gradients of the pretrained network
[2025-10-30 13:39:43,009][root][INFO] - Number of finetuned parameters: 553020
Processed step 0 of 500
Processed step 10 of 500
Processed step 20 of 500
Processed step 30 of 500
Processed step 40 of 500
Processed step 50 of 500
Processed step 60 of 500
Processed step 70 of 500
Processed step 80 of 500
Processed step 90 of 500
Processed step 100 of 500
Processed step 110 of 500
Processed step 120 of 500
Processed step 130 of 500
Processed step 140 of 500
Processed step 150 of 500
Processed step 160 of 500
Processed step 170 of 500
Processed step 180 of 500
Processed step 190 of 500
Processed step 200 of 500
Processed step 210 of 500
Processed step 220 of 500
Processed step 230 of 500
Processed step 240 of 500
Processed step 250 of 500
Processed step 260 of 500
Processed step 270 of 500
Processed step 280 of 500
Processed step 290 of 500
Processed step 300 of 500
Processed step 310 of 500
Processed step 320 of 500
Processed step 330 of 500
Processed step 340 of 500
Processed step 350 of 500
Processed step 360 of 500
Processed step 370 of 500
Processed step 380 of 500
Processed step 390 of 500
Processed step 400 of 500
Processed step 410 of 500
Processed step 420 of 500
Processed step 430 of 500
Processed step 440 of 500
Processed step 450 of 500
Processed step 460 of 500
Processed step 470 of 500
Processed step 480 of 500
Processed step 490 of 500
[2025-10-30 13:40:06,794][agent.finetune.train_agent][INFO] - Saved model to /projects/p30309/RL/dppo/log/gym-finetune/hopper-medium-v2_ppo_diffusion_mlp_ta4_td20_tdf10/2025-10-30_13-39-01_42/checkpoint/state_0.pt
[2025-10-30 13:40:06,795][agent.finetune.train_ppo_diffusion_agent][INFO] - eval: success rate   1.0000 | avg episode reward 1394.5805 | avg best reward   4.8073
Processed step 0 of 500
Processed step 10 of 500
Processed step 20 of 500
Processed step 30 of 500
Processed step 40 of 500
Processed step 50 of 500
Processed step 60 of 500
Processed step 70 of 500
Processed step 80 of 500
Processed step 90 of 500
Processed step 100 of 500
Processed step 110 of 500
Processed step 120 of 500
Processed step 130 of 500
Processed step 140 of 500
Processed step 150 of 500
Processed step 160 of 500
Processed step 170 of 500
Processed step 180 of 500
Processed step 190 of 500
Processed step 200 of 500
Processed step 210 of 500
Processed step 220 of 500
Processed step 230 of 500
Processed step 240 of 500
Processed step 250 of 500
Processed step 260 of 500
Processed step 270 of 500
Processed step 280 of 500
Processed step 290 of 500
Processed step 300 of 500
Processed step 310 of 500
Processed step 320 of 500
Processed step 330 of 500
Processed step 340 of 500
Processed step 350 of 500
Processed step 360 of 500
Processed step 370 of 500
Processed step 380 of 500
Processed step 390 of 500
Processed step 400 of 500
Processed step 410 of 500
Processed step 420 of 500
Processed step 430 of 500
Processed step 440 of 500
Processed step 450 of 500
Processed step 460 of 500
Processed step 470 of 500
Processed step 480 of 500
Processed step 490 of 500
[2025-10-30 13:40:33,330][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 0.0, update_epoch: 0, num_batch: 4
[2025-10-30 13:40:35,429][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.737875987208099e-07, update_epoch: 0, num_batch: 4
[2025-10-30 13:40:37,576][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 2.8000240490655415e-06, update_epoch: 0, num_batch: 4
[2025-10-30 13:40:39,730][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 4.066270776093006e-06, update_epoch: 0, num_batch: 4
[2025-10-30 13:40:41,881][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.052431788499234e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:40:44,139][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.9411349866422825e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:40:46,231][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.570865934918402e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:40:48,400][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.160434961406281e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:40:50,564][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.604183792864205e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:40:52,820][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.638967872480862e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:40:54,970][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.244164746429306e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:40:57,119][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.853367035044357e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:40:59,276][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.247120033251122e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:41:01,519][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.531480827718042e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:41:03,590][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.0117337296833284e-05, update_epoch: 3, num_batch: 4
[2025-10-30 13:41:05,749][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.049410548148444e-05, update_epoch: 3, num_batch: 4
[2025-10-30 13:41:07,899][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.1003595318470616e-05, update_epoch: 4, num_batch: 4
[2025-10-30 13:41:10,146][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.1139444723085035e-05, update_epoch: 4, num_batch: 4
[2025-10-30 13:41:12,220][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.153639914264204e-05, update_epoch: 4, num_batch: 4
[2025-10-30 13:41:14,389][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.1619798897299916e-05, update_epoch: 4, num_batch: 4
[2025-10-30 13:41:14,398][agent.finetune.train_ppo_diffusion_agent][INFO] - 1: step    80000 | loss   0.0053 | pg loss  -0.0005 | value loss   0.0115 | bc loss   0.0000 | reward 1222.9911 | eta   1.0000 | t: 67.6030
Processed step 0 of 500
Processed step 10 of 500
Processed step 20 of 500
Processed step 30 of 500
Processed step 40 of 500
Processed step 50 of 500
Processed step 60 of 500
Processed step 70 of 500
Processed step 80 of 500
Processed step 90 of 500
Processed step 100 of 500
Processed step 110 of 500
Processed step 120 of 500
Processed step 130 of 500
Processed step 140 of 500
Processed step 150 of 500
Processed step 160 of 500
Processed step 170 of 500
Processed step 180 of 500
Processed step 190 of 500
Processed step 200 of 500
Processed step 210 of 500
Processed step 220 of 500
Processed step 230 of 500
Processed step 240 of 500
Processed step 250 of 500
Processed step 260 of 500
Processed step 270 of 500
Processed step 280 of 500
Processed step 290 of 500
Processed step 300 of 500
Processed step 310 of 500
Processed step 320 of 500
Processed step 330 of 500
Processed step 340 of 500
Processed step 350 of 500
Processed step 360 of 500
Processed step 370 of 500
Processed step 380 of 500
Processed step 390 of 500
Processed step 400 of 500
Processed step 410 of 500
Processed step 420 of 500
Processed step 430 of 500
Processed step 440 of 500
Processed step 450 of 500
Processed step 460 of 500
Processed step 470 of 500
Processed step 480 of 500
Processed step 490 of 500
[2025-10-30 13:41:39,670][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 0.0, update_epoch: 0, num_batch: 4
[2025-10-30 13:41:41,747][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.696309888340693e-08, update_epoch: 0, num_batch: 4
[2025-10-30 13:41:43,898][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 3.1952265544532565e-07, update_epoch: 0, num_batch: 4
[2025-10-30 13:41:46,054][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.983411253713712e-07, update_epoch: 0, num_batch: 4
[2025-10-30 13:41:48,297][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.2527465287348605e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:41:50,372][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.9963440536230337e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:41:52,523][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 3.0461274036497343e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:41:54,751][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 4.092337348993169e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:41:57,003][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.024730853619985e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:41:59,082][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.674892690876732e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:42:01,229][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.260484951781109e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:42:03,395][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.532970928674331e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:42:05,633][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.657138783339178e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:42:07,711][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.983947969274595e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:42:09,862][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.359984920185525e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:42:12,030][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.69323651184095e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:42:14,282][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.084250112005975e-06, update_epoch: 4, num_batch: 4
[2025-10-30 13:42:16,361][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.637221071694512e-06, update_epoch: 4, num_batch: 4
[2025-10-30 13:42:18,519][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.13467192731332e-06, update_epoch: 4, num_batch: 4
[2025-10-30 13:42:20,670][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.419494745088741e-06, update_epoch: 4, num_batch: 4
[2025-10-30 13:42:20,679][agent.finetune.train_ppo_diffusion_agent][INFO] - 2: step   160000 | loss   0.0108 | pg loss  -0.0005 | value loss   0.0225 | bc loss   0.0000 | reward 1273.8238 | eta   1.0000 | t: 66.2810
Processed step 0 of 500
Processed step 10 of 500
Processed step 20 of 500
Processed step 30 of 500
Processed step 40 of 500
Processed step 50 of 500
Processed step 60 of 500
Processed step 70 of 500
Processed step 80 of 500
Processed step 90 of 500
Processed step 100 of 500
Processed step 110 of 500
Processed step 120 of 500
Processed step 130 of 500
Processed step 140 of 500
Processed step 150 of 500
Processed step 160 of 500
Processed step 170 of 500
Processed step 180 of 500
Processed step 190 of 500
Processed step 200 of 500
Processed step 210 of 500
Processed step 220 of 500
Processed step 230 of 500
Processed step 240 of 500
Processed step 250 of 500
Processed step 260 of 500
Processed step 270 of 500
Processed step 280 of 500
Processed step 290 of 500
Processed step 300 of 500
Processed step 310 of 500
Processed step 320 of 500
Processed step 330 of 500
Processed step 340 of 500
Processed step 350 of 500
Processed step 360 of 500
Processed step 370 of 500
Processed step 380 of 500
Processed step 390 of 500
Processed step 400 of 500
Processed step 410 of 500
Processed step 420 of 500
Processed step 430 of 500
Processed step 440 of 500
Processed step 450 of 500
Processed step 460 of 500
Processed step 470 of 500
Processed step 480 of 500
Processed step 490 of 500
[2025-10-30 13:42:45,676][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 0.0, update_epoch: 0, num_batch: 4
[2025-10-30 13:42:47,748][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.395426931429029e-08, update_epoch: 0, num_batch: 4
[2025-10-30 13:42:49,903][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 2.856473884094157e-07, update_epoch: 0, num_batch: 4
[2025-10-30 13:42:52,051][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.953838240202458e-07, update_epoch: 0, num_batch: 4
[2025-10-30 13:42:54,378][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.74206500359287e-07, update_epoch: 1, num_batch: 4
[2025-10-30 13:42:56,447][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.385828795719135e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:42:58,606][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 2.024401737799053e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:43:00,762][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 2.6736377094493946e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:43:03,012][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 3.4600734579726122e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:43:05,077][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 4.146643277636031e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:43:07,230][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 4.876941147813341e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:43:09,383][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.319176580087515e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:43:11,651][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.889243766432628e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:43:13,721][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.612805009353906e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:43:15,874][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.126974196580704e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:43:18,027][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.692293365835212e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:43:20,287][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.670563147461507e-06, update_epoch: 4, num_batch: 4
[2025-10-30 13:43:22,360][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.38429275265662e-06, update_epoch: 4, num_batch: 4
[2025-10-30 13:43:24,584][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.0099902283400297e-05, update_epoch: 4, num_batch: 4
[2025-10-30 13:43:26,739][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.0522265256440733e-05, update_epoch: 4, num_batch: 4
[2025-10-30 13:43:26,747][agent.finetune.train_ppo_diffusion_agent][INFO] - 3: step   240000 | loss   0.0174 | pg loss  -0.0003 | value loss   0.0354 | bc loss   0.0000 | reward 1311.9085 | eta   1.0000 | t: 66.0686
Processed step 0 of 500
Processed step 10 of 500
Processed step 20 of 500
Processed step 30 of 500
Processed step 40 of 500
Processed step 50 of 500
Processed step 60 of 500
Processed step 70 of 500
Processed step 80 of 500
Processed step 90 of 500
Processed step 100 of 500
Processed step 110 of 500
Processed step 120 of 500
Processed step 130 of 500
Processed step 140 of 500
Processed step 150 of 500
Processed step 160 of 500
Processed step 170 of 500
Processed step 180 of 500
Processed step 190 of 500
Processed step 200 of 500
Processed step 210 of 500
Processed step 220 of 500
Processed step 230 of 500
Processed step 240 of 500
Processed step 250 of 500
Processed step 260 of 500
Processed step 270 of 500
Processed step 280 of 500
Processed step 290 of 500
Processed step 300 of 500
Processed step 310 of 500
Processed step 320 of 500
Processed step 330 of 500
Processed step 340 of 500
Processed step 350 of 500
Processed step 360 of 500
Processed step 370 of 500
Processed step 380 of 500
Processed step 390 of 500
Processed step 400 of 500
Processed step 410 of 500
Processed step 420 of 500
Processed step 430 of 500
Processed step 440 of 500
Processed step 450 of 500
Processed step 460 of 500
Processed step 470 of 500
Processed step 480 of 500
Processed step 490 of 500
[2025-10-30 13:43:51,646][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 0.0, update_epoch: 0, num_batch: 4
[2025-10-30 13:43:53,801][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.998476465014392e-08, update_epoch: 0, num_batch: 4
[2025-10-30 13:43:55,958][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 2.200427218213008e-07, update_epoch: 0, num_batch: 4
[2025-10-30 13:43:58,201][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 4.524272299022414e-07, update_epoch: 0, num_batch: 4
[2025-10-30 13:44:00,277][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.500103151869553e-07, update_epoch: 1, num_batch: 4
[2025-10-30 13:44:02,428][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.1765421277232235e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:44:04,586][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.6339366766260355e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:44:06,821][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 2.203260919486638e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:44:08,898][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 2.997281399075291e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:44:11,053][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 4.0105992411554325e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:44:13,208][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.180897005629959e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:44:15,456][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.044849214958958e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:44:17,520][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.907266197231365e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:44:19,675][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.497585102100857e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:44:21,827][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.81743074185215e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:44:24,163][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.353060366061982e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:44:26,237][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.080101335712243e-06, update_epoch: 4, num_batch: 4
[2025-10-30 13:44:28,391][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.570711881679017e-06, update_epoch: 4, num_batch: 4
[2025-10-30 13:44:30,549][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.85906535788672e-06, update_epoch: 4, num_batch: 4
[2025-10-30 13:44:32,798][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.0401981853647158e-05, update_epoch: 4, num_batch: 4
[2025-10-30 13:44:32,807][agent.finetune.train_ppo_diffusion_agent][INFO] - 4: step   320000 | loss   0.0182 | pg loss  -0.0004 | value loss   0.0372 | bc loss   0.0000 | reward 1351.0631 | eta   1.0000 | t: 66.0595
Processed step 0 of 500
Processed step 10 of 500
Processed step 20 of 500
Processed step 30 of 500
Processed step 40 of 500
Processed step 50 of 500
Processed step 60 of 500
Processed step 70 of 500
Processed step 80 of 500
Processed step 90 of 500
Processed step 100 of 500
Processed step 110 of 500
Processed step 120 of 500
Processed step 130 of 500
Processed step 140 of 500
Processed step 150 of 500
Processed step 160 of 500
Processed step 170 of 500
Processed step 180 of 500
Processed step 190 of 500
Processed step 200 of 500
Processed step 210 of 500
Processed step 220 of 500
Processed step 230 of 500
Processed step 240 of 500
Processed step 250 of 500
Processed step 260 of 500
Processed step 270 of 500
Processed step 280 of 500
Processed step 290 of 500
Processed step 300 of 500
Processed step 310 of 500
Processed step 320 of 500
Processed step 330 of 500
Processed step 340 of 500
Processed step 350 of 500
Processed step 360 of 500
Processed step 370 of 500
Processed step 380 of 500
Processed step 390 of 500
Processed step 400 of 500
Processed step 410 of 500
Processed step 420 of 500
Processed step 430 of 500
Processed step 440 of 500
Processed step 450 of 500
Processed step 460 of 500
Processed step 470 of 500
Processed step 480 of 500
Processed step 490 of 500
[2025-10-30 13:44:57,699][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 0.0, update_epoch: 0, num_batch: 4
[2025-10-30 13:44:59,873][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.226585552189135e-08, update_epoch: 0, num_batch: 4
[2025-10-30 13:45:02,020][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 2.519910538012482e-07, update_epoch: 0, num_batch: 4
[2025-10-30 13:45:04,268][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.659466637553123e-07, update_epoch: 0, num_batch: 4
[2025-10-30 13:45:06,351][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 9.696625511423917e-07, update_epoch: 1, num_batch: 4
[2025-10-30 13:45:08,499][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 1.5282320191545296e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:45:10,662][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 2.3527770736109233e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:45:12,904][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 3.339871454954846e-06, update_epoch: 1, num_batch: 4
[2025-10-30 13:45:14,981][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 4.412032922118669e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:45:17,131][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 5.6458425206074025e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:45:19,279][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 6.652392130490625e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:45:21,533][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 7.645229743502568e-06, update_epoch: 2, num_batch: 4
[2025-10-30 13:45:23,681][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.21048888610676e-06, update_epoch: 3, num_batch: 4
[2025-10-30 13:45:25,836][agent.finetune.train_ppo_diffusion_agent][INFO] - approx_kl: 8.526189049007371e-06, update_epoch: 3, num_batch: 4
```

- Restart from the beginning

```sh
$ python script/run.py --config-name=ft_ppo_diffusion_mlp --config-dir=cfg/gym/finetune/hopper-v2 wandb=null
Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
Compiling /home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/cymj.pyx because it changed.
[1/1] Cythonizing /home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/cymj.pyx
[2025-10-31 00:19:54,336][root][INFO] - running build_ext
[2025-10-31 00:19:54,361][root][INFO] - building 'mujoco_py.cymj' extension
[2025-10-31 00:19:54,362][root][INFO] - creating /home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/generated/_pyxbld_2.1.2.14_310_linuxgpuextensionbuilder/temp.linux-x86_64-cpython-310/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py
[2025-10-31 00:19:54,367][root][INFO] - creating /home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/generated/_pyxbld_2.1.2.14_310_linuxgpuextensionbuilder/temp.linux-x86_64-cpython-310/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/gl
[2025-10-31 00:19:54,368][root][INFO] - gcc -pthread -B /home/kzy816/.conda/envs/dppo_310_1/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/kzy816/.conda/envs/dppo_310_1/include -fPIC -O2 -isystem /home/kzy816/.conda/envs/dppo_310_1/include -fPIC -I/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py -I/home/kzy816/.mujoco/mujoco210/include -I/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/numpy/core/include -I/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/vendor/egl -I/home/kzy816/.conda/envs/dppo_310_1/include/python3.10 -c /home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/cymj.c -o /home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/generated/_pyxbld_2.1.2.14_310_linuxgpuextensionbuilder/temp.linux-x86_64-cpython-310/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/cymj.o -fopenmp -w
[2025-10-31 00:20:23,534][root][INFO] - gcc -pthread -B /home/kzy816/.conda/envs/dppo_310_1/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/kzy816/.conda/envs/dppo_310_1/include -fPIC -O2 -isystem /home/kzy816/.conda/envs/dppo_310_1/include -fPIC -I/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py -I/home/kzy816/.mujoco/mujoco210/include -I/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/numpy/core/include -I/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/vendor/egl -I/home/kzy816/.conda/envs/dppo_310_1/include/python3.10 -c /home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/gl/eglshim.c -o /home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/generated/_pyxbld_2.1.2.14_310_linuxgpuextensionbuilder/temp.linux-x86_64-cpython-310/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/gl/eglshim.o -fopenmp -w
/home/kzy816/.conda/envs/dppo_310_1/lib/python3.10/site-packages/mujoco_py/gl/eglshim.c:4:10: fatal error: GL/glew.h: No such file or directory
 #include <GL/glew.h>
          ^~~~~~~~~~~
compilation terminated.
```
